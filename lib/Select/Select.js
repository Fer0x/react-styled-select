(function(a,b){if('function'==typeof define&&define.amd)define(['exports','react','prop-types','styled-components','react-click-outside','uuid','./Async','../helpers/shadowDOM','./constants','./partials/Select','./partials/SelectMenu','./partials/SelectValue','./partials/SelectMultiValue','./partials/SelectClear','./partials/SelectArrow','./partials/SelectInput','./partials/SelectInputField','./partials/SelectInputFieldSize','./partials/SelectControl','./partials/SelectNoResults','./partials/SelectClearZone','./partials/SelectArrowZone','./partials/SelectMenuOuter','./partials/SelectPlaceholder','./partials/SelectValueWrapper','./partials/SelectMultiValueWrapper','./renderers/ValueRenderer','./renderers/OptionRenderer','./functions/stringifyValue'],b);else if('undefined'!=typeof exports)b(exports,require('react'),require('prop-types'),require('styled-components'),require('react-click-outside'),require('uuid'),require('./Async'),require('../helpers/shadowDOM'),require('./constants'),require('./partials/Select'),require('./partials/SelectMenu'),require('./partials/SelectValue'),require('./partials/SelectMultiValue'),require('./partials/SelectClear'),require('./partials/SelectArrow'),require('./partials/SelectInput'),require('./partials/SelectInputField'),require('./partials/SelectInputFieldSize'),require('./partials/SelectControl'),require('./partials/SelectNoResults'),require('./partials/SelectClearZone'),require('./partials/SelectArrowZone'),require('./partials/SelectMenuOuter'),require('./partials/SelectPlaceholder'),require('./partials/SelectValueWrapper'),require('./partials/SelectMultiValueWrapper'),require('./renderers/ValueRenderer'),require('./renderers/OptionRenderer'),require('./functions/stringifyValue'));else{var c={exports:{}};b(c.exports,a.react,a.propTypes,a.styledComponents,a.reactClickOutside,a.uuid,a.Async,a.shadowDOM,a.constants,a.Select,a.SelectMenu,a.SelectValue,a.SelectMultiValue,a.SelectClear,a.SelectArrow,a.SelectInput,a.SelectInputField,a.SelectInputFieldSize,a.SelectControl,a.SelectNoResults,a.SelectClearZone,a.SelectArrowZone,a.SelectMenuOuter,a.SelectPlaceholder,a.SelectValueWrapper,a.SelectMultiValueWrapper,a.ValueRenderer,a.OptionRenderer,a.stringifyValue),a.Select=c.exports}})(this,function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){'use strict';function D(a){return a&&a.__esModule?a:{default:a}}function E(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function F(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function G(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function H(a,b){return a[b.value]=b,a}Object.defineProperty(a,'__esModule',{value:!0}),a.ShadowDOM=a.Async=void 0;var I=D(b),J=D(c),K=D(d),L=D(e),M=D(f),N=D(g),O=D(h),P=D(j),Q=D(k),R=D(l),S=D(m),T=D(n),U=D(o),V=D(p),W=D(q),X=D(r),Y=D(s),Z=D(t),$=D(u),_=D(v),aa=D(w),ba=D(x),ca=D(y),da=D(z),ea=D(A),fa=D(B),ga=D(C),ha=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),ia=1,ja=function(a){function b(a){E(this,b);var c=F(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));c.indexValues(a);var d=[];return a.value&&c.optionsMap.hasOwnProperty(a.value)&&d.push(a.value),Array.isArray(a.value)&&(d=d.concat(a.value)),c.state={values:new Set(d),isOpened:!1,isFocused:!1,isSelected:!1,searchTerm:null,searchWidth:1,focusedIndex:0,options:a.options,"aria-owns":c.props['aria-owns']||M.default.v4(),"input-field-id":M.default.v4()},c.inputInnerRef=null,c.searchSizeRef=null,c.shouldFireClickOutsideHack=null,c.onSearchingBinded=c.onSearching.bind(c),c.onRemoveTagBinded=c.onRemoveTag.bind(c),c.onClearValueBinded=c.onClearValue.bind(c),c.onSelectValueBinded=c.onSelectValue.bind(c),c.onSelectFocusedBinded=c.onSelectFocused.bind(c),c}return G(b,a),ha(b,[{key:'indexValues',value:function(a){this.optionsMap=a.options.reduce(H,{})}},{key:'openOptions',value:function(){this.setState({options:this.getOptions(),focusedIndex:0,isOpened:!0}),this.props.onOpen()}},{key:'closeOptions',value:function(){this.setState({isOpened:!1}),this.props.onClose()}},{key:'setFocus',value:function(){var a=this;setTimeout(function(){a.inputInnerRef&&a.inputInnerRef.focus()},10)}},{key:'handleClickOutside',value:function(){this.state.isOpened&&this.shouldFireClickOutsideHack&&(this.closeOptions(),this.shouldFireClickOutsideHack=!1)}},{key:'onRemoveTag',value:function(a,b){var c=this;b.stopPropagation();this.props.multi;this.state.values.delete(a.value),this.setState({values:new Set(Array.from(this.state.values))},function(){c.props.onChange(Array.from(c.state.values))})}},{key:'resetField',value:function(){var a=this,b=this.props.multi,c=[];b&&(c=Array.from(this.state.values),c.pop(),this.props.onChange(c)),this.setState({values:new Set(c),searchTerm:null,focusedIndex:0,options:this.props.options},function(){a.closeOptions(),a.inputInnerRef.value='',a.props.onInputClear()})}},{key:'onClearValue',value:function(a){a.preventDefault(),a.stopPropagation(),this.resetField()}},{key:'onSelectValue',value:function(a,b){var c=this,d=this.props.multi,e=this.state.values;d||e.clear(),e.has(a)||(e.add(a),this.setState({values:e,searchTerm:null,focusedIndex:0},function(){c.inputInnerRef.value='',c.props.onChange(d?Array.from(e):a)})),this.closeOptions(),this.props.onValueClick(d?Array.from(e):a,b)}},{key:'onSelectFocused',value:function(){var a=this;this.shouldFireClickOutsideHack=!1,clearInterval(this.focusedTimeout),this.focusedTimeout=setTimeout(function(){a.shouldFireClickOutsideHack=!0},200),this.setState({isFocused:!0}),this.openOptions(),this.setFocus()}},{key:'getOptions',value:function(){var a=this.props.multi,b=this.state.values;return this.props.options.filter(function(c){var d=c.label.toLowerCase().trim();return b.has(d)&&a?!1:!0})}},{key:'onSearching',value:function(a){var b=this,c=this.props,d=c.onInputChange,e=c.onTyping,f=this.state,g=f.focusedIndex,h=f.options,j=f.isOpened,k=function(){var a=b.inputInnerRef.value.toLowerCase().trim();e(a);var c=b.getOptions().filter(function(b){var c=b.label.toLowerCase().trim();return-1!==c.indexOf(a)});b.setState({searchTerm:b.inputInnerRef.value,searchWidth:d,options:c,isOpened:!0,focusedIndex:0});var d=ia;if(b.searchSizeRef){var f=b.searchSizeRef.getBoundingClientRect().width;d=f>ia?f:ia}setTimeout(function(){b.setState({searchWidth:d})})},l=h.length-1;switch(a.keyCode){case i.KEY_BACKSPACE:if(!this.inputInnerRef.value){this.resetField();break}setTimeout(k,1);break;case i.KEY_UP:this.setState({focusedIndex:0>=g?l:g-1});break;case i.KEY_DOWN:if(!j){this.openOptions();break}this.setState({focusedIndex:g>=l?0:g+1});break;case i.KEY_ENTER:if(!h.length)break;var m=h[g].value;this.onSelectValueBinded(m,a);break;case i.KEY_ESC:this.closeOptions();break;default:setTimeout(k,1);}}},{key:'renderSelectMultiValueWrapper',value:function(){var a=this,b=this.props,c=b.multi,d=b.placeholder,e=b.searchable,f=b.classes,g=b.valueRenderer,h=this.state,i=h.values,j=h.isOpened,k=h.isSelected,l=h.searchTerm,m=h.searchWidth,n=c?S.default:R.default,o=c?da.default:ca.default,p='';return i.size&&(p=Array.from(i).map(function(b,d){return I.default.createElement(n,{value:b,onRemoveTag:a.onRemoveTagBinded,key:d,className:f.selectValue,"data-select-value":!0,"data-multi-value":c},g({multi:c,value:b,label:a.optionsMap[b].label},f.selectValueLabel))})),i.size||l||(p=I.default.createElement(ba.default,{className:f.selectPlaceholder,"data-select-placeholder":!0},d)),e?I.default.createElement(o,{for:this.state['input-field-id'],className:f.selectMultiValueWrapper,"data-select-multi-value-wrapper":c},p,I.default.createElement(V.default,{"data-select-input":!0,className:f.selectInput},I.default.createElement(W.default,{style:{width:m+'px'},id:this.state['input-field-id'],className:f.selectInputField,"data-select-input-search":!0,onKeyDown:this.onSearchingBinded,onChange:this.props.onInputChange,innerRef:function(b){return a.inputInnerRef=b},"aria-label":d,"aria-expanded":j,"aria-owns":this.state['aria-owns'],role:'combobox',type:'text'})),I.default.createElement(X.default,{"data-select-input-size":!0,innerRef:function(b){return a.searchSizeRef=b}},l)):I.default.createElement(o,{for:this.state['input-field-id'],innerRef:function(b){return a.inputInnerRef=b},className:f.selectMultiValueWrapper,"data-select-multi-value-wrapper":c},p)}},{key:'renderSelectMenuOuter',value:function(){var a=this,b=this.props,c=b.classes,d=b.noResultsText,e=b.optionRenderer,f=this.state,g=f.values,h=f.isOpened,j=f.focusedIndex,i=f.options;if(!h)return I.default.createElement('div',{"aria-hidden":'true',id:['aria-owns'],role:'listbox'},I.default.createElement('div',{role:'option',tabIndex:'-1'}));var k=I.default.createElement(Z.default,null,d);return 0<i.length&&(k=i.map(function(b,d){var f=g.has(b.value);return e(Object.assign({key:d,"data-key":d,isSelected:f,id:a.state['aria-owns'],className:c.selectOption,isFocused:j==d,tabIndex:g.has(b.value)?'0':'-1',onMouseOver:function(b){var c=b.target.getAttribute('data-key');a.setState({focusedIndex:c})},onMouseOut:function(){a.setState({focusedIndex:null})},onMouseDown:function(c){return a.onSelectValueBinded(b.value,c)}},b),d)})),I.default.createElement(aa.default,{className:c.selectMenuOuter,"data-select-menu-outer":!0},I.default.createElement(Q.default,{role:'listbox',className:c.selectMenu,"data-select-menu":!0},k))}},{key:'renderSelectClearZone',value:function(){var a=this.props,b=a.clearable,c=a.classes;return b?I.default.createElement($.default,{className:c.selectClearZone,"data-select-clear-zone":!0,onMouseDown:this.onClearValueBinded},I.default.createElement(T.default,{className:c.selectClear,"data-select-clear":!0},'\xD7')):void 0}},{key:'componentDidMount',value:function(){this.props.generatedClassName(this.selectNode.state.generatedClassName)}},{key:'componentDidUpdate',value:function(){this.props.generatedClassName(this.selectNode.state.generatedClassName)}},{key:'componentWillReceiveProps',value:function(a){var b=this;this.setState({options:a.options},function(){return b.indexValues(a)})}},{key:'render',value:function(){var a=this,b=this.props,c=b.name,d=b.disabled,e=b.className,f=b.classes,g=this.state,h=g.value,i=g.isSelected,j=g.isOpened;return I.default.createElement(P.default,{"data-select":!0,className:e,ref:function(b){return a.selectNode=b},innerRef:function(b){return a.selectInnerRef=b}},I.default.createElement('input',{type:'hidden',name:c,value:(0,ga.default)(h),disabled:d}),I.default.createElement(Y.default,{isOpened:j,"aria-haspopup":j,className:f.selectControl,"data-select-control":!0,onMouseDown:this.onSelectFocusedBinded},this.renderSelectMultiValueWrapper(),this.renderSelectClearZone(),I.default.createElement(_.default,{className:f.selectArrowZone,"data-select-arrow-zone":!0},I.default.createElement(U.default,{isOpened:j,className:f.selectArrow,"data-select-arrow":!0}))),this.renderSelectMenuOuter())}}]),b}(I.default.PureComponent);ja.propTypes={value:J.default.any,options:J.default.array,onClose:J.default.func,onOpen:J.default.func,onChange:J.default.func,onValueClick:J.default.func,onInputClear:J.default.func,clearable:J.default.bool,placeholder:J.default.string,className:J.default.string,classes:J.default.object,noResultsText:J.default.oneOfType([J.default.string,J.default.element]),generatedClassName:J.default.func},ja.defaultProps={onClose:function(){},onOpen:function(){},onChange:function(){},onInputChange:function(){},onTyping:function(){},onValueClick:function(){},onInputClear:function(){},clearable:!1,searchable:!0,multi:!1,options:[],placeholder:'Select...',noResultsText:'No results found',classes:{selectArrow:'',selectArrowZone:'',selectClear:'',selectClearZone:'',selectControl:'',selectInput:'',selectInputField:'',selectMenu:'',selectMenuOuter:'',selectMultiValueWrapper:'',selectOption:'',selectPlaceholder:'',selectValue:'',selectValueLabel:''},valueRenderer:ea.default,optionRenderer:fa.default,generatedClassName:function(){}};var ka=(0,L.default)(ja),la=(0,O.default)(ka);la.Async=function ShadowAsync(a){return I.default.createElement(N.default,a,I.default.createElement(la,null))};var ma=a.Async=ka.Async=function NormalAsync(a){return I.default.createElement(N.default,a,I.default.createElement(ka,null))},na=a.ShadowDOM=ka.ShadowDOM=la;a.default=ka});
//# sourceMappingURL=Select.js.map